version: 1.0
provider:
  name: openfaas
  gateway: http://127.0.0.1:8080
functions:
  nats-test:
    lang: python3-debian
    handler: ./nats-test
    image: lolopop/nats-test:latest
    imagePullPolicy: IfNotPresent    
    labels:
      com.openfaas.scale.zero: true
      com.openfaas.scale.min: "1"
      com.openfaas.scale.max: "1"
      instance.idle: false
    limits: 
      cpu: 1000m
      memory: 256Mi
    requests: 
      cpu: 1000m
      memory: 256Mi  
    environment:
      BATCH_SIZE: "1"
      RESOLUTION: "512x512"      
      NATS_ADDRESS: "nats://10.244.0.105:4222"
      NATS_SUBJECT: "image-test"